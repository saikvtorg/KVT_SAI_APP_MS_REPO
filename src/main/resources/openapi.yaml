openapi: 3.0.3
info:
  title: Exhibition Management System API
  description: API for managing exhibitions, modules, stalls, and user preferences.
  version: 1.0.0
servers:
  - url: /api/
paths:
  /auth/register:
    post:
      summary: Register a new user
      operationId: registerUser
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterUser'
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          description: Invalid request body or email already in use
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auth/login:
    post:
      summary: Authenticate a user
      operationId: loginUser
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginUser'
      responses:
        '200':
          description: User logged in successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Admin Endpoints
  /admin/exhibitions:
    post:
      summary: Create a new exhibition
      operationId: createExhibition
      tags:
        - Admin
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewExhibition'
      responses:
        '201':
          description: Exhibition created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Exhibition'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - not an admin
    get:
      summary: Retrieve all exhibitions
      operationId: getExhibitions
      tags:
        - Admin
      security:
        - BearerAuth: []
      responses:
        '200':
          description: A list of exhibitions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExhibitionList'
        '401':
          description: Unauthorized
  /admin/exhibitions/{exhibitionId}:
    get:
      summary: Retrieve a single exhibition by ID
      operationId: getExhibitionById
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: exhibitionId
          in: path
          required: true
          schema:
            type: string
          description: The ID of the exhibition to retrieve
      responses:
        '200':
          description: Exhibition details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Exhibition'
        '401':
          description: Unauthorized
        '404':
          description: Exhibition not found
    put:
      summary: Update an existing exhibition
      operationId: updateExhibition
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: exhibitionId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateExhibition'
      responses:
        '200':
          description: Exhibition updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Exhibition'
        '401':
          description: Unauthorized
        '404':
          description: Exhibition not found
    delete:
      summary: Delete an exhibition
      operationId: deleteExhibition
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: exhibitionId
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Exhibition deleted successfully
        '401':
          description: Unauthorized
        '404':
          description: Exhibition not found
  /admin/exhibitions/{exhibitionId}/modules:
    post:
      summary: Create a new module
      operationId: createModule
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: exhibitionId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewModule'
      responses:
        '201':
          description: Module created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Module'
        '401':
          description: Unauthorized
        '404':
          description: Exhibition not found
    get:
      summary: Retrieve all modules for an exhibition
      operationId: getModulesForExhibition
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: exhibitionId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: A list of modules
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ModuleList'
        '401':
          description: Unauthorized
        '404':
          description: Exhibition not found
  /admin/modules/{moduleId}:
    put:
      summary: Update an existing module
      operationId: updateModule
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: moduleId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateModule'
      responses:
        '200':
          description: Module updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Module'
        '401':
          description: Unauthorized
        '404':
          description: Module not found
    delete:
      summary: Delete a module
      operationId: deleteModule
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: moduleId
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Module deleted successfully
        '401':
          description: Unauthorized
        '404':
          description: Module not found
  /admin/modules/{moduleId}/stalls:
    post:
      summary: Create a new stall
      operationId: createStall
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: moduleId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewStall'
      responses:
        '201':
          description: Stall created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Stall'
        '401':
          description: Unauthorized
        '404':
          description: Module not found
  /admin/stalls/{stallId}:
    put:
      summary: Update an existing stall
      operationId: updateStall
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: stallId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateStall'
      responses:
        '200':
          description: Stall updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Stall'
        '401':
          description: Unauthorized
        '404':
          description: Stall not found
    delete:
      summary: Delete a stall
      operationId: deleteStall
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: stallId
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Stall deleted successfully
        '401':
          description: Unauthorized
        '404':
          description: Stall not found
  /admin/stalls/{stallId}/content:
    post:
      summary: Add or update poster content for a stall
      operationId: addOrUpdateContent
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: stallId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewPosterContent'
      responses:
        '201':
          description: Content created/updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PosterContent'
        '401':
          description: Unauthorized
        '404':
          description: Stall not found
    get:
      summary: Retrieve all poster content for a stall
      operationId: getStallContent
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: stallId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: A list of poster content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PosterContentList'
        '401':
          description: Unauthorized
        '404':
          description: Stall not found
  /admin/questionnaires:
    post:
      summary: Create a new questionnaire
      operationId: createQuestionnaire
      tags:
        - Admin
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewQuestionnaire'
      responses:
        '201':
          description: Questionnaire created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Questionnaire'
        '401':
          description: Unauthorized
    get:
      summary: Retrieve all questionnaires
      operationId: getAdminQuestionnaires
      tags:
        - Admin
      security:
        - BearerAuth: []
      responses:
        '200':
          description: A list of all questionnaires
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestionnaireList'
        '401':
          description: Unauthorized
  /admin/questionnaires/{questionnaireId}:
    put:
      summary: Update an existing questionnaire
      operationId: updateQuestionnaire
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: questionnaireId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewQuestionnaire'
      responses:
        '200':
          description: Questionnaire updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Questionnaire'
        '401':
          description: Unauthorized
        '404':
          description: Questionnaire not found

  # User Endpoints
  /exhibitions:
    get:
      summary: Retrieve a list of published exhibitions
      operationId: getPublishedExhibitions
      tags:
        - User
      security:
        - BearerAuth: []
      parameters:
        - name: location
          in: query
          required: false
          schema:
            type: string
          description: Filter exhibitions by location
      responses:
        '200':
          description: A list of published exhibitions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExhibitionList'
        '401':
          description: Unauthorized
  /exhibitions/{exhibitionId}:
    get:
      summary: Retrieve a single exhibition and its modules
      operationId: getPublishedExhibitionById
      tags:
        - User
      security:
        - BearerAuth: []
      parameters:
        - name: exhibitionId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Exhibition details with modules
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Exhibition'
        '401':
          description: Unauthorized
        '404':
          description: Exhibition not found
  /modules/{moduleId}:
    get:
      summary: Retrieve a single module and its stalls
      operationId: getModuleById
      tags:
        - User
      security:
        - BearerAuth: []
      parameters:
        - name: moduleId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Module details with stalls
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Module'
        '401':
          description: Unauthorized
        '404':
          description: Module not found
  /stalls/{stallId}:
    get:
      summary: Retrieve a single stall's details and content
      operationId: getStallById
      tags:
        - User
      security:
        - BearerAuth: []
      parameters:
        - name: stallId
          in: path
          required: true
          schema:
            type: string
        - name: language
          in: query
          required: false
          schema:
            type: string
          description: The content language to retrieve (defaults to user's preference)
      responses:
        '200':
          description: Stall details with content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Stall'
        '401':
          description: Unauthorized
        '404':
          description: Stall not found
  /me/questionnaires:
    get:
      summary: Get active questionnaires for the user
      operationId: getUserQuestionnaires
      tags:
        - User
      security:
        - BearerAuth: []
      responses:
        '200':
          description: A list of active questionnaires
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MyQuestionnaireList'
        '401':
          description: Unauthorized
  /me/preferences:
    post:
      summary: Submit user answers to a questionnaire
      operationId: submitUserPreferences
      tags:
        - User
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserAnswers'
      responses:
        '201':
          description: Preferences submitted successfully
        '400':
          description: Invalid request body
        '401':
          description: Unauthorized
  /me/notifications:
    get:
      summary: Retrieve user's notifications
      operationId: getUserNotifications
      tags:
        - User
      security:
        - BearerAuth: []
      responses:
        '200':
          description: A list of notifications
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MyNotificationList'
        '401':
          description: Unauthorized
  /me/notifications/preferences:
    put:
      summary: Update a user's notification preferences
      operationId: updateNotificationPreferences
      tags:
        - User
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationPreferences'
      responses:
        '200':
          description: Preferences updated successfully
        '401':
          description: Unauthorized

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
    RegisterUser:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
        fullName:
          type: string
        preferredLanguage:
          type: string
      required:
        - email
        - password
        - fullName
        - preferredLanguage
    LoginUser:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
      required:
        - email
        - password
    TokenResponse:
      type: object
      properties:
        token:
          type: string
        userId:
          type: string
        role:
          type: string
    ExhibitionList:
      type: array
      items:
        $ref: '#/components/schemas/Exhibition'
    Exhibition:
      type: object
      properties:
        exhibitionId:
          type: string
        name:
          type: string
        description:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        location:
          type: string
        status:
          type: string
          enum: [Draft, Published]
        modules:
          type: array
          items:
            $ref: '#/components/schemas/Module'
    NewExhibition:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        location:
          type: string
        status:
          type: string
          enum: [Draft, Published]
    UpdateExhibition:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        location:
          type: string
        status:
          type: string
          enum: [Draft, Published]
    ModuleList:
      type: array
      items:
        $ref: '#/components/schemas/Module'
    Module:
      type: object
      properties:
        moduleId:
          type: string
        name:
          type: string
        description:
          type: string
        assignedTeamId:
          type: string
        stalls:
          type: array
          items:
            $ref: '#/components/schemas/Stall'
    NewModule:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        assignedTeamId:
          type: string
    UpdateModule:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        assignedTeamId:
          type: string
    StallList:
      type: array
      items:
        $ref: '#/components/schemas/Stall'
    Stall:
      type: object
      properties:
        stallId:
          type: string
        name:
          type: string
        description:
          type: string
        stallNumber:
          type: string
        layout:
          type: string
        posterContent:
          type: array
          items:
            $ref: '#/components/schemas/PosterContent'
    NewStall:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        stallNumber:
          type: string
        layout:
          type: string
    UpdateStall:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        stallNumber:
          type: string
        layout:
          type: string
    PosterContentList:
      type: array
      items:
        $ref: '#/components/schemas/PosterContent'
    PosterContent:
      type: object
      properties:
        contentId:
          type: string
        languageCode:
          type: string
        posterMediaUrl:
          type: string
        contentText:
          type: string
    NewPosterContent:
      type: object
      properties:
        languageCode:
          type: string
        posterMediaUrl:
          type: string
        contentText:
          type: string
    QuestionnaireList:
      type: array
      items:
        $ref: '#/components/schemas/Questionnaire'
    Questionnaire:
      type: object
      properties:
        questionnaireId:
          type: string
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [Draft, Active, Archived]
        questions:
          type: array
          items:
            $ref: '#/components/schemas/Question'
    NewQuestionnaire:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [Draft, Active, Archived]
        questions:
          type: array
          items:
            $ref: '#/components/schemas/Question'
    UpdateQuestionnaire:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [Draft, Active, Archived]
        questions:
          type: array
          items:
            $ref: '#/components/schemas/Question'
    Question:
      type: object
      properties:
        questionText:
          type: string
        answerType:
          type: string
          enum: [MultipleChoice, FreeText, Rating]
        options:
          type: array
          items:
            type: string
    MyQuestionnaireList:
      type: array
      items:
        $ref: '#/components/schemas/Questionnaire'
    UserAnswers:
      type: object
      properties:
        questionnaireId:
          type: string
        answers:
          type: array
          items:
            $ref: '#/components/schemas/UserAnswer'
    UserAnswer:
      type: object
      properties:
        questionId:
          type: string
        answer:
          type: string
    MyNotificationList:
      type: array
      items:
        $ref: '#/components/schemas/Notification'
    Notification:
      type: object
      properties:
        notificationId:
          type: string
        message:
          type: string
        linkTo:
          type: string
        isRead:
          type: boolean
    NotificationPreferences:
      type: object
      properties:
        preferences:
          type: array
          items:
            $ref: '#/components/schemas/NotificationPreference'
    NotificationPreference:
      type: object
      properties:
        notificationType:
          type: string
          enum: [Email, In-App, Push]
        category:
          type: string
        enabled:
          type: boolean
      required:
        - notificationType
        - category
        - enabled
